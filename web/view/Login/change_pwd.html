{% extends '../public/main.html' %}
{% block title %}重置密码{% end %}
{% block body %}
<div class="passport">
    <div class="signBox">
        <h2>重置密码</h2>
        <label><span>新密码</span><input type="password" value=""><em class="errorTips"><b>◆</b>密码错误提示</em></label>
        <label><span>确认密码</span><input type="password" value=""><em class="errorTips"><b>◆</b>密码错误提示</em></label>
        <button class="submitBtn" type="submit" onclick="savePwd()">重置</button>
    </div>
</div>
<!-- 旧代码
<div class="change-pwd-box">
    <div class="title">重置密码</div>
    <div class="change-form">
        <div style="margin-left:-170px;">新密码<input type="password" id="pwd0" maxlength="32"></div>
        <div style="margin-left:-202px;">确认新密码<input type="password" id="pwd1" maxlength="32"></div>
        <div class="btn-with-blueBg-and-addBtn btn" style="margin-left: -103px;" onclick="savePwd()">确定</div>
    </div>
</div>
<script type="text/javascript">
    var isSending = false;
    var strEmail = "{{ email }}";
    var strToken = "{{ token }}";
    function savePwd(){
        if($('#pwd0').val().length<6){
            showTipsBox('alert','请输入至少6位数密码');
        }else if($('#pwd0').val()!==$('#pwd1').val()){
            showTipsBox('alert','两次输入密码不相同');
        }else{
            $('#loading').show();
            if(isSending)return;
            isSending = true;
            var ss = location.search;
            if(ss==null||ss==undefined||ss==''){

            }
            ss = ss.replace('?','');
            var obj = {};
            var list = ss.split('&');
            for(var i=0;i<list.length;i++){
                var aa = list[i].split('=');
                obj[aa[0]]=aa[1];
            }
            if(!strEmail || !strToken){
                showTipsBox('alert','数据有误，无法修改密码');
                return false;
            }
            $.ajax({
                url:'/login?a=change_pwd',
                dataType:'json',
                type:'post',
                data: {
                    'v': strToken,
                    'email': strEmail,
                    'password': $.trim($('#pwd0').val()),
                    're_password': $.trim($('#pwd1').val())
                },
                success:function(d){
                    if(d.status == 200){
                        location.href = "/";
                    }else{
                        showTipsBox('alert',data.msg);
                    }
                    $('#loading').fadeOut();
                    isSending = false;
                },
            })
        }

    }
</script>
-->
{% end %}
